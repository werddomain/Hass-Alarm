var Panel=function(){function n(){var n=this,t;this.actions={arm:"arm",disarm:"disarm",arm_home:"arm_home",unlock:"unlock"};this.lockTimerHandler=null;this.display=$("#code");t=this;this.pin="";this.numbers=$("#numberInputs .numberinput");$(".btn-lock").click(function(){n.Lock()});$(".cmdButton").click(function(){var n=$(this).data("state");t.action(n)});$(".content").click(function(t){var u=$(t.target),i=u.find(".number"),r=i.text();i.hasClass("accept")?(n.action(n.actions.unlock),n.ClearPin()):i.hasClass("delete")?(n.pin.length>0&&(n.pin=n.pin.substr(0,n.pin.length-1)),$($(".numberinput").get().reverse()).each(function(){var n=$(this).text();if(n)return $(this).text(""),$(this).removeClass("nocircle"),!1})):r!=="<"&&n.pin.length<n.numbers.length&&(n.pin+=r,$(".numberinput").each(function(){var n=$(this).text();if(!n)return $(this).text("*"),$(this).addClass("nocircle"),!1}));$("#pin-code").val(n.pin)});$("#num-panel .num").click(function(t){var i=$(t.target);n.pin=n.pin+i.text()});$("#num-panel .back").click(function(){n.pin=n.pin.slice(0,-1)});$("#num-panel .go").click(function(){n.action("unlock")});$("form[ajax=true]").submit(function(n){n.preventDefault();var i=$(this).serialize(),r=$(this).attr("action"),u=$(this).attr("method").toUpperCase();$("#loadingimg").show();$.ajax({url:r,type:u,data:i,cache:!1,success:function(n){var i=$("#action-field").val();n.code_invalid?t.invalidCode():($("#msg-invalid-code").addClass(".hidden"),i==t.actions.arm||i==t.actions.arm_home?t.Lock():t.Unlock(),t.displayState(n.state));$("#loadingimg").hide()}})});this.displayState($("#msg-state").data("state"))}return Object.defineProperty(n.prototype,"pin",{get:function(){return this._pin},set:function(n){this._pin=n;this.display.val(this._pin);$("#pin-code").val(this._pin)},enumerable:!0,configurable:!0}),n.prototype.bindEvents=function(){},n.prototype.invalidCode=function(){$("#msg-invalid-code").removeClass("hidden")},n.prototype.displayState=function(n){var t=$("#msg-state i"),i=$("#msg-state span"),r=$("#msg-state");if(n!=this.actions.unlock)switch(n){case this.actions.arm:t.attr("class","mdi mdi-bell-alert");i.text("Armed");r.attr("class","alert alert-danger");break;case this.actions.arm_home:t.attr("class","mdi mdi-bell-circle");i.text("Armed at home");r.attr("class","alert alert-warning");break;case this.actions.disarm:t.attr("class","mdi mdi-bell-off");i.text("Disarmed");r.attr("class","alert alert-success")}},n.prototype.action=function(n){$("#action-field").val(n);$("#send").click()},n.prototype.ClearPin=function(){this.numbers.removeClass("nocircle");this.pin=""},n.prototype.refreshLock=function(){var n=this;this.lockTimerHandler&&clearTimeout(this.lockTimerHandler);this.lockTimerHandler=setTimeout(function(){n.Lock()},3e4)},n.prototype.Unlock=function(){$(".UnLocked").removeClass("hidden");$(".Locked").addClass("hidden");this.refreshLock()},n.prototype.Lock=function(){this.lockTimerHandler&&clearTimeout(this.lockTimerHandler);this.lockTimerHandler=null;this.ClearPin();$("#pin-code").val("");$(".UnLocked").addClass("hidden");$(".Locked").removeClass("hidden")},n.prototype.refreshDisplay=function(n){this.ClearPin();this.isAuthorized(n)?(this.Unlock(),this.displayState(n.State)):this.Lock()},n.prototype.isAuthorized=function(n){return n.authorized==!0},n}(),p=new Panel;